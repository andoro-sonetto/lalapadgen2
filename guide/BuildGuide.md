# ビルドガイド

> [!TIP]
> 本ページは LaLaPad Gen2 のビルドガイドです。
> 
## このガイドについて
### 対象読者
- 初めて自作キーボードを組み立てる方を対象としています。
- はんだごての取り扱いなど、最低限の電子工作の知識や技術がある方を対象としています。
- Windows PCを使用している方を主な対象としています。MacやLinuxを使用されている方は内容を適宜読み替えて実施してください。

### 作業全体の目安
- 想定作業時間：60～180分
- 難易度：キット全体の難易度としては中程度。マイコン取付の難易度が高く、フラックスやはんだ吸い取り線、状態の良いこて先など、正しく道具を揃える必要があります。
  - ソケット取付★☆☆☆☆
  - 5Way取付★☆☆☆☆
  - マイコン取付★★★★★
  - 筐体組み立て★★☆☆☆

> [!WARNING]
> - 電子工作初心者の方はこの目安に捉われず、十分に時間をかけて作業していただいて問題ありません。

## 準備

### キット内容物の確認

|パッキング | 内容 | 数量 | 単位 |
| --- | --- | --: | --- |
|-|3DP製ケース|1|Set|
|-|Socket|42|個|
|-|スタンド|4|個|
|ESDバッグ大|PCB本体|1|枚|
|ESDバッグ小|PCBトラックパッド|2|枚|
|ESDバッグ小|FFC6pin|2|枚|
|ポチ袋①|5Wayスイッチ|2|個|
|ポチ袋①|LEDpipe|2|個|
|ポチ袋①|マグネット|4|個|
|ポチ袋②|オーバレイ|2|枚|
|ポチ袋②|5Wayノブ|2|個|
|ポチ袋②|SW＆RSTパーツ|2|Set|
|ポチ袋②|ガスケットパーツ|2|Set|
|ポチ袋②|ゴム足|4|本|

`TODO:[画像プレースホルダ: キット内容物の全体写真]`

> [!WARNING]
> - 内容物に不足があった場合、Boothのメッセージにてショップオーナーにお問い合わせください。
> - お問い合わせへの対応は、購入履歴のあるBoothアカウントからのご連絡が条件となります。あらかじめご了承ください。


### 別途用意するもの
| 名前 | 数 | 備考 |参考商品|
|:-|---:|:-|:-|
|Seeed Studio XIAO nRF52840 Plus|2個|マイコン本体。XIAO BLEの新バージョンです。9本の追加GPIOが使用でき、より高機能なデバイスに適しています。|[遊舎工房](https://shop.yushakobo.jp/products/10946) [beekeeb.jp](https://shop.beekeeb.jp/products/seeed-studio-xiao-nrf52840-plus) [千石電商](https://www.sengoku.co.jp/mod/sgk_cart/detail.php?code=EEHD-6TTL) [スイッチサイエンス](https://www.switch-science.com/products/10468)|
|Kailh Choc V2互換スイッチ|42個|静音ではDeepSeaMiniがおすすめ、打鍵感はもちもち寄り。<BR/>鳴らしつつ打鍵感の軽さを求める場合、COSMOXのShadow huntingをPBTキーキャップと組み合わせるとコリコリ感があって好みです。個人的な意見です。|[TALPKEYBOARD](https://shop.talpkeyboard.com/collections/kailh-chocv2) [遊舎工房](https://shop.yushakobo.jp/collections/all-switches/Kailh-Choc-V2%E3%82%B9%E3%82%A4%E3%83%83%E3%83%81) [Amazon](https://www.amazon.co.jp/dp/B0DSSS4MYJ/) |
|MX軸ロープロファイルキーキャップ|42個|入手性の高さ、バリエーションの豊富さからWomierのPBTキーキャップをおすすめしています。 ※19mmピッチ用且つ、サイズは1Uが38個、1.5Uが4個必要です。|[Womier](https://womierkeyboard.com/products/skyline-r2) [Amazon](https://www.amazon.co.jp/stores/page/90526727-85E5-4BF8-AAD2-FC8A78C07BE3/search?ref_=ast_bln&store_ref=bl_ast_dp_brandLogo_sto&terms=%E3%83%AD%E3%83%BC%E3%83%97%E3%83%AD)|
|3.7Vリチウムポリマーバッテリー|2個|603048型（厚さ6.3mm幅47mm長さ110mm以下）、JST PHコネクタ（ソケットのピッチ2.0mm）※[ソケットの極性に注意！](https://github.com/ShiniNet/LaLaPadGen2/blob/main/guide/BuildGuide.md#%E3%83%90%E3%83%83%E3%83%86%E3%83%AA%E3%83%BC%E5%8B%95%E4%BD%9C%E7%A2%BA%E8%AA%8D)|[Amazon](https://www.amazon.co.jp/dp/B09DRJS75J/) [PHコネクタ単品](https://www.amazon.co.jp/dp/B01MXGWMS5/) |
|USB-Cケーブル|2本|充電、ファームウェア書き込み用。何百回と抜き差しすることになるのでマグネット式がおすすめ。||

### 道具類
|優先度| 名前 | 備考 |参考商品|
|---|:-|:-|:-|
|必須|はんだごて|安心と信頼の白光（HAKKO）製はんだ付け入門キット。|[amazon](https://www.amazon.co.jp/dp/B0FX3L5485)|
|必須|こて先（K型）|本ビルドガイドではマイコンのはんだ付けにK型のこて先を推奨しています。安心と信頼の白光(HAKKO)製。|[amazon](https://www.amazon.co.jp/dp/B004ORB8MY/)|
|必須|フラックス|端子へのはんだが吸着しやすくなります。マイコン等シビアなはんだ作業では必須。注射器型。無洗浄タイプ。|[amazon](https://www.amazon.co.jp/dp/B078XSQF5T/)|
|必須|はんだ線|精密プリント基板用、極細（0.8mm以下）鉛入り低融点（200度未満）で入手性の高い物を選択。|[amazon](https://www.amazon.co.jp/dp/B0DQ54YDF4/)|
|大|はんだ吸い取り線|ミスしたはんだを吸い取ります。セットに付いてなかったら購入必須。<BR>はんだ済み端子はフラックスが蒸発しているので、フラックスと組み合わせて使用。|[amazon](https://www.amazon.co.jp/dp/B0DWM8W136/)|
|大|こて先クリーナー|こて先の酸化対策に有効なワイヤータイプ。|[amazon](https://www.amazon.co.jp/dp/B000AQQFMG/)|
|必須|ピンセット|はんだ中のパーツ固定用。||
|中|ニッパー|基板の分離用。||
|中|やすり|基板のばり取り用。ピンセットやニッパーの縁で削っても良い。||
|中|マスキングテープ|バッテリーの固定、はんだ中にパーツを仮止めする用。||
|中|瞬間接着剤|圧入したマグネットが取れてしまう場合の固定用。||
|中|テスター|電源投入前に配線のショートをチェックできるので怖さが減ります。またトラブル発生時にサポートのやりとりするために必須となっています。|[amazon](https://www.amazon.co.jp/dp/B0BLZ7GN2X)|
|中|ミニホットプレート|トラブル時にマイコンを取り外すために必須です。本ビルドガイドでは200℃出せるもので十分です。PD65W以上に対応したUSB-C充電器とケーブルが必要です。ヒートガンでも代用可能。|[amazon](https://www.amazon.co.jp/dp/B0DGFFP4CG/)|
|代替品|はんだごて|中級者向け。安価で高出力高機能なはんだごてを使ってみたい場合、FNIRSI社製のスマートはんだごてもおすすめです。バリエーションHS-02B-Kは最初からK型のこて先付き。PD100W以上対応のUSB-C充電器とケーブルが必要です。|[アリエク](https://ja.aliexpress.com/item/1005008870209545.html)|

> [!WARNING]
> - 参考商品はすべてアフィリエイトを含まない直リンクです。
> - 参考商品はあくまで参考であり、すべての商品が検証済みではないことにご注意ください。


## 道具を買い揃えたくない方、工作する場所がない方、技術に不安のある方。
- 東京にお住まいの方は遊舎工房の工作室が利用可能です。
- 工作室の利用、工具のレンタル、はんだ付けの技術サポートを受けることができます。
- 詳細は[遊舎工房のWEBページ](https://yushakobo.jp/shopinfo/)をご確認ください。
  

## はんだ付け作業前の準備
- はんだごての取り扱い方がわからないことに起因するトラブルが大変多くなっております。
- はんだ付けが初めての場合、作業を始める前に以下の動画に一度目を通しておくことをおすすめします。
- https://youtu.be/dQ7AUjb1tkA?t=1198

![image](https://github.com/user-attachments/assets/83b540a6-6ee8-4ddb-bd2a-ac00fa3dd708)

よくあるはんだ付け注意ポイントは以下のとおりです。
- 初心者は鉛入り低融点はんだを使う
- こて先の温度管理（330度前後推奨）
- 細すぎるこて先（B型など）は使わない（本ガイドではK型を推奨）
- 基板のランド＆パーツへしっかり熱を伝える（加熱時間を増やすのではなく、こて先の表面が広くランド＆パーツの両方に触れるように意識し、点ではなく線もしくは面で密着させる）
- 以下のケースではフラックスが蒸発しているのでフラックスを塗布する
  - はんだが溶けづらい。パーツに吸着しづらい
  - はんだ付け後、こて先を離した時にはんだがトガる
  - はんだ付け後の仕上がりに光沢がない。ボロボロとしている
- こて先が酸化してはんだが弾かれてしまう時の対策
  - 使用直前に糸はんだを付ける＆クリーンを繰り返すおまじないが有効。
  - 酸化膜の除去には金たわしタイプのクリーナーが有効。
  - 状態がひどい場合はチップリフレッサーを使うか、諦めて品質の良いこて先を買う。
- はんだごてを一時的に使用しないときは、こて先にはんだをのせた状態で電源を切り、酸化を防ぐ。

## PCBの組み立て

### PCBの前処理
- ニッパー等で赤丸で囲ったランナー部分をカットします。（素手でも折れると思います）

<img width="2058" height="768" alt="2026-02-22_19h42_47" src="https://github.com/user-attachments/assets/c0009840-4969-43ea-9bb8-3fd0595d3fa5" />

> [!WARNING]
> - スイッチを巻き込まないように注意！スイッチとは反対方向に折り曲げて分離するようにしてください。
<img width="1024" height="524" alt="2026-02-22_19h45_04" src="https://github.com/user-attachments/assets/7d9ac846-3eb1-41e4-855a-a9804c664079" />


- メイン基板のバリ取りをします（任意）
- トラックパッド基板のバリ取りをします（必須）

> [!WARNING]
> - 特にトラックパッドはバリによって外形線が膨らむと、後述のカバーにはまらなくなる可能性があるので事前に処理してください。


### ソケットの実装

- PCBの裏面の左右合計42箇所へホットスワップソケットを取り付けていきます。

> [!WARNING]
> - ソケットの向きに注意してください。ソケットの突起とPCBのマークが一致するように。
> - はんだはたっぷり目で接合してください。キースイッチ着脱中にソケットが脱落する原因になります。

<img width="2220" height="1032" alt="2026-02-22_18h58_25" src="https://github.com/user-attachments/assets/c2c6f02a-af6d-402a-b738-958e8f89e414" />

![IMG_20260212_175935](https://github.com/user-attachments/assets/73ecb63c-1b17-4452-8108-dda6425e245f)



### マイコンの実装
- PCBの表面からマイコンに同梱されていたピンヘッダを差し込み、その反対側からマイコンを差し込んで仮固定します。

> [!WARNING]
> - マイコンはPCBの裏面に固定してください。ソケットやIC類が実装されている面です。
> - ピンヘッダをはんだ付けしないでください。あとで取り外します。

<img width="2343" height="1081" alt="2026-02-22_19h11_49" src="https://github.com/user-attachments/assets/e51c00bd-5f3e-4c65-b89a-11d11e81e2f0" /><BR/> 
  
<BR/>  
  
- ピンヘッダが刺さっていない方のピンをはんだ付けしていきます。

> [!TIP]
> - 端子にフラックスを塗布し、K型のこて先で加熱しながらはんだを流し込んでいきます。
> - マイコン端子側面とPCBのランドの両方を加熱することを意識します。
> - 十分なフラックスと、流し込むはんだの量が適切なら、こて先をスライドさせることで勝手にはんだの表面張力で接合されていきます。
> - はんだが多すぎてブリッジしてしまった場合、落ち着いてフラックスを追加し、はんだ吸い取り線で余分なはんだを除去します。

<img width="2615" height="1080" alt="2026-02-22_19h17_11" src="https://github.com/user-attachments/assets/f9d9049d-119a-4f29-9c6e-57074507eb8f" /><BR/> 

- ピンヘッダを取り外し、残りのピンもはんだ付けしていきます。

> [!WARNING]
> - ピンヘッダはなるべく垂直にゆっくり引き抜き、マイコンに応力がかからないように注意してください。はんだ済みのピンがPCBのランドごと剥がれてしまいます。

<img width="2121" height="1080" alt="2026-02-22_19h40_38" src="https://github.com/user-attachments/assets/31ddc20a-95b2-42ab-a42b-eb85761e4006" /><BR/> 

- マイコン背面端子をはんだ付けします（4ピン）

> [!TIP]
> - 端子にフラックスを塗布し、こて先で加熱しながらはんだを流し込んでいきます。
> - マイコンのバッテリ端子の露出が極狭（画像2枚目）なので、K型こて先の先端を上手く使ってマイコン背面端子とPCBの端面スルーホールを加熱してください。
> - こて先が酸化していると上手く熱が伝わらず、はんだが吸着しないのでこて先をよくクリーニングしてください。
> - 大量のフラックスとはんだを流し込み、わざとブリッジさせてからはんだ吸い取り線で余分なはんだを除去する手法も有効です。

<img width="1665" height="768" alt="2026-02-22_20h00_16" src="https://github.com/user-attachments/assets/43663235-e21a-4c00-b2c1-ded590d175db" /><BR/> 


### 5Wayスイッチの実装
- 5WayスイッチをPCBの表面（マイコンとは反対側）に配置し、6本の足をはんだ付けします。

> [!TIP]
> - 5Wayスイッチの裏面に突起があるので、それがPCB側の穴にはまるように位置合わせをしてください。
> - 5Wayスイッチの足とPCBのランド両方をこて先で加熱することを意識してはんだ付けしてください。足だけ加熱するとランドにはんだが吸着しないことが多いです。

![IMG_20260212_183225](https://github.com/user-attachments/assets/4ac60ab3-6409-4ee7-9eab-af4d3cfaac61)<BR/> 


### トラックパッドモジュールの組み立て
- 向きに注意しながら、トラックパッドケースにトラックパッドPCBを挿入します。

> [!WARNING]
> - トラックパッドPCB側面のバリ取りが完了していることを事前に確認してください。バリが残っているとケース内でPCBが浮いてしまい、センサーとケースの間に空間ができることで誤動作の原因になります。
> - ケースの突起がある方を目印に、トラックパッドPCBの向きに注意して挿入してください。
> - 表面実装部品は大変取れやすくなっております。何かに引っ掛けて脱落させないよう注意してください。

<img width="1025" height="891" alt="2026-02-23_16h18_00" src="https://github.com/user-attachments/assets/36512ba2-b328-448b-9684-c9a215a3a28e" /><BR/>

### 動作確認前チェックポイント
- ここまでの工程を両手側でそれぞれ完了させます。

> [!WARNING]
> - マイコンのはんだ付け作業後、動作確認のために通電させるまで最低でも10分以上の時間を開けてから行うようにしてください。フラックスクリーナー等が揮発する前に通電させるとショートしてマイコンが破損する可能性があります。

## ファームウェア書き込みと初期動作確認（USB）

### 事前準備
- [ファームウェアリポジトリのビルド履歴を開き、一番上にあるファームウェア](https://github.com/ShiniNet/zmk-config-LalaPadGen2/actions/workflows/build.yml)のZIPファイルを取得します。（右手用・左手用・リセットファーム全部入り）

<img width="2004" height="826" alt="image" src="https://github.com/user-attachments/assets/c47ce15c-6cbe-4af5-afcd-6235fc22ebb2" />
<img width="701" height="320" alt="2026-02-23_20h06_15" src="https://github.com/user-attachments/assets/d466f08f-e738-4655-8130-0ad1c8a48268" /><BR/>

### 書き込み手順
- PCとマイコンをUSBで接続した状態でリセットボタンを2回押してブートローダーへ入ります。
- マイコン本体左上の小さなボタンと、PCB側のリセットボタンどちらを2連打してもブートローダーの起動が可能です。
  
> [!TIP]
> - 動作に問題がある場合、[組立のトラブルシューティング](https://github.com/ShiniNet/LaLaPadGen2/blob/main/guide/BuildGuide.md#%E7%B5%84%E7%AB%8B%E3%81%AE%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0)を参考にしてください。

![IMG_20260212_192502](https://github.com/user-attachments/assets/9fa0479c-29bd-48cc-ae65-c62b75fd0497)<BR/>

- マウントされたドライブがフォルダとして自動的に開くので `.uf2` をコピーします。
- 右手側には`lalapadgen2_right*.uf2`をコピーします。
- 左手側には`lalapadgen2_left*.uf2`をコピーします。

<img width="877" height="562" alt="2026-02-23_20h11_11" src="https://github.com/user-attachments/assets/caa0adad-ba58-4ed5-ad7c-54b335c29ae3" /><BR/>

- ファームウェアの書き込みが完了すると自動的にフォルダが閉じられ、マイコンが再起動し緑のLEDが点灯します。

> [!WARNING]
> - Macの場合、ここでエラーメッセージが表示される場合がありますが、LEDが点灯していれば書き込み完了していますので無視して問題ありません。
> - LEDが点灯しない場合、ファームウェアの書き込みに失敗している可能性があります。
> - ZIPファイルから直接ファイルをコピーするのではなく、一度ZIPファイルを解凍（展開）してから、展開後のフォルダにあるUF2ファイルを投入してみてください。
> - それでもLEDが点灯しない場合、マイコンのはんだ不良の可能性があります。

> [!TIP]
> - 動作に問題がある場合、[組立のトラブルシューティング](https://github.com/ShiniNet/LaLaPadGen2/blob/main/guide/BuildGuide.md#%E7%B5%84%E7%AB%8B%E3%81%AE%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0)を参考にしてください。

![IMG_20260212_192622](https://github.com/user-attachments/assets/49b2845f-56d0-4509-8e56-36ffc3812f3c)<BR/>

### キー入力の動作確認
- 右手側、左手側の順番でUSBを接続し、左右間のペアリングの確認をしてください。USBケーブルが2本必要です。
- 左手側を起動した時に緑→青のLEDが点灯したら左右間のペアリングに成功しています。

> [!WARNING]
> - 左手側が起動しても緑→赤とLEDが点灯する場合、ペアリングに失敗しています。
> - 左右どちらも一度電源を落としてから手順を再試行してみてください。
> - それでも解決しない場合、一度リセットファームウェア（ZIPファイルに同梱）をマイコンに書き込んで初期化したのち、再び通常のファームウェア書き込みから手順をやり直してみてください。



- ピンセット等でキーソケットの金具部分を導通させ、キーの入力を確認します。
- 左右の5Wayスイッチを全方向に倒し、キーの入力を確認します。
- 任意の[キーボード入力テスト用のWEBサイト](https://www.onlinemictest.com/ja/keyboard-test/)にて、動作確認を行います。
- [デフォルトキーマップ](https://github.com/ShiniNet/LaLaPadGen2/blob/main/guide/HowtoUse.md#%E3%83%87%E3%83%95%E3%82%A9%E3%83%AB%E3%83%88%E3%82%AD%E3%83%BC%E3%83%9E%E3%83%83%E3%83%97)の設定を確認しながら、全ての物理キーが正しく判定されることを確認してください。

> [!TIP]
> - 動作に問題がある場合、[組立のトラブルシューティング](https://github.com/ShiniNet/LaLaPadGen2/blob/main/guide/BuildGuide.md#%E7%B5%84%E7%AB%8B%E3%81%AE%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0)を参考にしてください。

![IMG_20260212_192655](https://github.com/user-attachments/assets/0156de79-8c68-4704-90a1-27c3de0d0883)<BR/>
<img width="1332" height="673" alt="2026-02-23_20h30_45" src="https://github.com/user-attachments/assets/50d6e799-72bd-42f5-ae73-604537bfc321" /><BR/>

### トラックパッドの動作確認
- 一度マイコンからUSBを取り外し、PCBとトラックパッドをFFC（フレキシブルフラットケーブル）で接続します。
- 接続したら再度マイコンへUSBを接続し、電源を投入します。
- マイコンのLED点灯を確認してから２～３秒待機したのち、トラックパッドに触れてPCのカーソルが動くことを確認してください。
- 左右両側にトラックパッドを装着してそれぞれ動作することを確認してください。

> [!WARNING]
> - FFCの向きに注意してください。どちらのソケットも青い面が手前に見える方向へ挿入します。
> - 画像ではトラックパッドが裸になっていますが、動作確認時には必ずトラックパッドケースを装着するようにしてください。動作不良の原因になります。
> - マイコン起動中はトラックパッドから指を離しておいてください。キャリブレーションがズレる可能性があります。

> [!TIP]
> - マイコン起動後にトラックパッドが動作しない場合、リセットボタンを1回押してマイコンを再起動してみてください。
> - それでも動作に問題がある場合、[組立のトラブルシューティング](https://github.com/ShiniNet/LaLaPadGen2/blob/main/guide/BuildGuide.md#%E7%B5%84%E7%AB%8B%E3%81%AE%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0)を参考にしてください。

<img width="1026" height="1081" alt="2026-02-23_20h46_19" src="https://github.com/user-attachments/assets/f6fc979f-b789-481b-a9c8-b340592d98fd" /><BR/>

### バッテリー動作確認
- 左右ともマイコンからUSBを取り外し、代わりにバッテリーを接続します。
- PCBの電源スイッチをマイコン側へスライド（ON）します。
- PCBのLEDが点灯しキーボードが起動することを確認します。
- PCや周辺のBLE対応の端末から周辺機器を検索し、`lalapadgen2`が検出され、ペアリングできることを確認してください。
- バッテリーが接続された状態でUSBをマイコンに接続し、バッテリーへの充電が開始されることを確認してください。（赤LEDが点灯）

> [!WARNING]
> - バッテリーの極性に注意してください。ソケットに差し込む方向に対して右側が赤（プラス）になるバッテリーを使用してください。

> [!TIP]
> - 動作に問題がある場合、[組立のトラブルシューティング](https://github.com/ShiniNet/LaLaPadGen2/blob/main/guide/BuildGuide.md#%E7%B5%84%E7%AB%8B%E3%81%AE%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0)を参考にしてください。

![IMG_20260212_193828](https://github.com/user-attachments/assets/f718810d-dcbf-451d-9033-94a99ac24a41)<BR/>



## ケースへの組み込み

### PCBへのトッププレート・キースイッチ・LEDパイプ取り付け

- 予めトラックパッドからFFCを取り外し、FFCをPCB背面から表面に通しておきます。

<img width="1546" height="610" alt="2026-02-23_21h49_05" src="https://github.com/user-attachments/assets/68f0f28f-843b-4555-8a01-72c2f9683bae" /><BR/>

- PCBへトッププレート＆キースイッチを取り付けます。

> [!TIP]
> - この時点でキーキャップや5Wayノブは付けても付けなくても良いです。

<img width="1024" height="1124" alt="2026-02-23_21h14_53" src="https://github.com/user-attachments/assets/6752b538-0188-4be9-a44b-938d09704d5a" /><BR/>

- PCB背面にLEDパイプを取り付けます。

 <img width="1546" height="720" alt="2026-02-23_21h39_38" src="https://github.com/user-attachments/assets/2038015e-0f7c-4b91-9b03-608c787f9970" /><BR/>


### ボトムケース仮組み
- ボトムケースへマグネット、スタンド、ゴム足を取り付けていきます。
- スタンドとゴム足は両面テープ付きですので保護シールを剥がしてから貼り付けてください。

> [!TIP]
> - マグネットは脱落防止のためにかなり強めに圧入する必要があります。
> - それでもマグネットが脱落してしまう場合、内側から瞬間接着剤やボンド等で固定すると更に強化されます。
> - マグネットやスタンドは、最後まで挿入した状態でボトムプレートから１ミリ弱ほどはみ出している状態が正常です。

> [!WARNING]
> - マグネットの極性に注意！マグネットを完全に固定する前に、左右のボトムケースそれぞれが底面同士で張り付くことを確認してください。

<img width="1030" height="774" alt="2026-02-23_21h19_22" src="https://github.com/user-attachments/assets/ee0c3036-68b8-46fb-8a81-9e26396851b1" /><BR/>


### ボトムケースへPCB＆バッテリーの組み込み
- バッテリーをボトムケースへ固定します。
- 電源スイッチ＆リセットスイッチカバーをボトムケースへ組み込みます。
- TPUマウントをPCBの四隅に固定します。一番大きいタイプがマイコンのあるコーナー用です。

> [!WARNING]
> - バッテリーの固定に厚みのある両面テープ等を使用しないでください。打鍵時プレートが沈み込みバッテリーと干渉する可能性があります。
> - 電源スイッチカバーは張り出している側が下向きになるように取り付けてください。

<img width="1030" height="774" alt="2026-02-23_21h29_00" src="https://github.com/user-attachments/assets/a339d7e3-e96e-4f03-af6c-01765f724ac6" /><BR/>
![IMG_20260212_1949001](https://github.com/user-attachments/assets/3ba8a903-1b85-441e-bdb9-f27b55a4cfd6)<BR/>

- PCBを慎重にボトムケースへ挿入します。
- 最終的にPCBがボトムプレートの全周から1ミリ程度隙間が空いている状態になるようにしてください。

> [!TIP]
> - PCBに付いているLEDパイプを先にボトムケースの穴に通すように挿入すると作業しやすいです。

> [!WARNING]
> - 電源スイッチの位置と電源スイッチカバーの噛み合いがズレないように気をつけてください。

<img width="1815" height="744" alt="2026-02-23_21h37_21" src="https://github.com/user-attachments/assets/3cc3128e-0f6f-468a-995a-e220417dd01e" /><BR/>

### アウターケースの組み込み
- 上からアウターケースをはめ込んでいきます。

> [!TIP]
> - 電源スイッチのある方から挿入すると作業しやすいです。

![IMG_20260212_195106](https://github.com/user-attachments/assets/0b046a06-57f1-407d-a477-e6f18bd20613)<BR/>

### トラックパッドの取り付け
- トラックパッドとFFCを接続します。
- トラックパッドケースのツメを手前側からアウターケースの穴に挿入し、その後奥側にスライドして固定します。

> [!WARNING]
> - トラックパッドケースの突起が手前になる向きで挿入するようにしてください。これがストッパーになります。
> - トラックパッド手前のキーキャップは予め取り外しておく必要があります。

<img width="1162" height="512" alt="2026-02-23_21h59_35" src="https://github.com/user-attachments/assets/959826c4-cd30-49c4-b719-6c082c832051" /><BR/>


### キーキャップとノブの取り付け
- キーキャップとノブをすべて取り付けて完成です。

![IMG_20260219_184850](https://github.com/user-attachments/assets/009a9bba-30d0-4385-af1d-75a963bc6dcd)<BR/>

> [!TIP]
> お疲れさまでした。  
> 次は [キーボードの使い方・カスタマイズ](https://github.com/ShiniNet/LaLaPadGen2/blob/main/guide/HowtoUse.md) を参考にキーボードの使い方を確認し、好みに合わせてキーマップの調整を行ってください。

<BR/><BR/>

# 組立のトラブルシューティング
随時追記中・・・

- DiscordのHelpチャンネルでも過去のトラブルの事例を確認することができますので、是非ご参加ください！ <BR/>
  ※招待コードはパッケージに同梱されています
- キーボードの使用方法や接続に関するトラブルシューティングは[こちら]()


## マイコンのはんだ不良チェック（要テスター）
- マイコンの隣り合った端子がブリッジしてショートしていないかチェックしてください。
- マイコン端子（緑枠）とPCBのテストポイント（青枠）をテスターで導通チェックすることで、マイコン側のはんだ不良を特定できます。
- BAT+とRESET端子はテスターによる導通確認ができないので、バッテリーからの電源供給や充電の可否、PCBリセットボタンの動作結果によって判断してください。

> [!WARNING]
> - お使いのテスターを導通チェックモード（または抵抗値測定モード）にしてから検証してください。
> - マイコン側にプローブを当てる際、マイコンの上面からマイコンの端子にだけプローブが触れるようにしてください。PCBのランドにも接触していると100%導通してしまうのでチェックになりません。

> [!WARNING]
> - マイコンのはんだ付け作業後、動作確認のために通電させるまで最低でも10分以上の時間を開けてから行うようにしてください。フラックスクリーナー等が揮発する前に通電させるとショートしてマイコンが破損する可能性があります。

<img width="716" height="773" alt="2026-02-24_11h50_21" src="https://github.com/user-attachments/assets/6a88a163-71f4-490e-998e-66d172c04a81" /><BR/>
![IMG_20260212_1925021](https://github.com/user-attachments/assets/c2c5e209-26ef-44f6-8ae5-17b80488820d)<BR/>


## マイコンが起動しない
### ブートローダーが起動しない
- マイコンのリセットボタンを2連打したのにUSBを接続したPC側でフォルダが自動表示されない場合、電源系（5V,GND,3V3,BAT+,BAT-）の端子がショートしている可能性がありますので、すみやかにUSBを取り外し、はんだ不良のチェックをしてください。
- 端子に異常がないのにフォルダが自動表示されない場合、すでにドライブのマウント自体はされている可能性があります。PCのデバイスとドライブ画面から`XIAO-BOOT`が表示されていないか直接確認してみてください。

<img width="811" height="285" alt="2026-02-24_12h15_37" src="https://github.com/user-attachments/assets/4f4af8ba-ab32-4d5a-982b-e7c5168c2966" /><BR/>

### マイコンが起動しない（LEDが点灯しない）
- マイコン初期状態やリセットファームウェア投入後はLEDが点灯しなくても正常です。（リセットボタン2連打でフォルダが開けば基本的にマイコンは生きている）
- キー入力等はできているがLEDだけ点灯しない場合は、マイコンのR,G,B端子のはんだ不良をチェックしてください。

## バッテリーから給電されない
- "BAT+、BAT-"のはんだ不良をチェックしてください。
## バッテリーが充電されない（充電時に赤LEDが点灯しない）
- "BAT+、BAT-"のはんだ不良をチェックしてください。
- "C" のはんだ不良をチェックしてください。
## トラックパッドが動作しない
- キーボードの電源再投入して改善するか確認
- リセットボタンを押して再起動後に改善するか確認
- 無線接続で問題が発生している場合、USB接続では動作するか確認
- FFC（フレキシブルフラットケーブル）がねじれて反転して接続されていないか確認
- マイコンのはんだ付けを確認（3V3,GND,RESET,SDA,SCL,DR）
- トラックパッド着脱時に部品をひっかけて脱落させていないか目視確認
## 特定のキーが動作しない
### 行単位でキーが動作しない（ASDFGがまるごと動作しないなど）
- "ROW0~ROW3"のはんだ不良をチェックしてください。
### 列単位でキーが動作しない（EDCがまるごと動作しないなど）
- "COL0~COL5"のはんだ不良をチェックしてください。
### 特定の1キーが反応しない
- ホットスワップソケットのはんだ付けを確認してください。
- キースイッチのピンが折れ曲がって挿入されていないか確認
- PC側のキーボード物理配列がUS配列モードになっているか確認
- 割り当てしているキーコードを変更して動作するか確認
## 5Wayスイッチが反応しない
- 5Wayスイッチのはんだ不良をチェックしてください。
- "ROW4"のはんだ不良をチェックしてください。
- "COL0~COL4"のはんだ不良をチェックしてください。

## その他ソフトウェア・ハードウェアの問題切り分け（未整理）
- リセットファームウェアを投入してからLaLaPadGen2のデフォルトファームウェアを投入し、USBでPCに接続し動作確認（キャッシュ＆改変されたファームの問題切り分け）
- 最新のファームウェアを使用していますか？[ファームウェアリポジトリのビルド履歴を開き、一番上にあるファームウェア](https://github.com/ShiniNet/zmk-config-LalaPadGen2/actions/workflows/build.yml)を取得して、再試行してみてください。
- PCに接続時、ZMK Studioの画面を開いていないこと。（再接続時に画面上の内容でキーボードの設定が上書きされる可能性。）
- 左右キーボードの電源が切られていることを確認し、ICから電荷を十分に抜いてから右手側、左手側の順番に起動する。
- そもそも投入したファームウェアがLaLaPadGen2用かチェック。（過去作のリポジトリを参照していたケース）
- ペアリング済みのデバイス（PC等）に再接続できない時
  - キーボードの電源が入った状態で、システムレイヤーのBLE CLEAR ALLボタンを押下してキーボード側のBLEプロファイルを全削除する。黄色LED点灯を確認する。
  - PC側でキーボードのBLEペアリング情報を削除したのち、再度ペアリングする
- トラックパッドを取り外した状態でトラックパッド以外が正常動作するか確認（トラックパッドの不良切り分け）
- トラックパッドを左右で付け替えて問題が起こるか確認（トラックパッドの不良切り分け）
- トラックパッド操作時に手袋等をしていないこと。濡れた指で操作していないこと。（感度不良）
- トラックパッドの起動時に指を触れていないこと（キャリブレーション失敗）
- キーボードの周囲や、キーボードとPC側のBLEドングルの間に大きな金属製の物品を置かないこと。ステンレスマグカップ、モニター、デスクの天板、棚、大型の金属製タブレットスタンドなど。（通信安定性）
- **BLEイヤホン・ヘッドホンなど帯域を多く消費する無線機器と同じドングルを共有しないこと。**（通信安定性）
- 電磁波や電波の混信が激しい環境でキーボードを使用しないこと。そういう環境では有線モード推奨。（電子レンジ、高圧線、スマホ、オフィス、イベント会場）

## 故障したマイコンを交換する（はんだごて＆ミニホットプレート使用）
- ミニホットプレートの設定温度を200℃に設定します。
- マイコンの背面パッドにはんだを流し込んでブリッジさせ、熱伝導性を高めます。
- マイコンの表裏各端子にフラックスを塗布します。
- ホットプレートが設定温度になったら、はんだごてでマイコン背面パッドのはんだを再び予熱します。溶ければ問題ありません。
- 手早くPCBを反転してホットプレートにセットします。
- はんだごてでマイコン表面の両サイドの端子を加熱してはんだを十分に溶かします。
- 裏面＆表面両サイドのピンが十分に加熱されればマイコンを取り外せるようになるので、ピンセットでマイコンを外します。
- PCB＆マイコン（再利用する場合のみ）に残ったはんだを吸い取り線等で丁寧に除去します。
  
<img width="1430" height="926" alt="2026-02-24_14h03_58" src="https://github.com/user-attachments/assets/714e4299-ead9-49dd-bba9-03d115e92764" /><BR/>

  
- `TODO: 映像付き解説`

