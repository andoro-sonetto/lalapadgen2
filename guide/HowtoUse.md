
# キーボードの使い方

## 電源の入れ方、充電方法

- 電源スイッチをON（奥行き側）にするか、USB-Cケーブルをマイコンに接続すると起動します。
- 充電はUSB-Cポート経由で行います。電源スイッチがON/OFFの状態によらず、どちらもバッテリーが充電されます。
　※キーボードを充電したままの外出や就寝は控え、絶対に目を離さないようにしてください。
- バッテリー残量はキーボード起動時にLEDインジケーター（後述）に表示されます。

## PC等デバイスへの接続と使用
- セントラル（右手側）の電源投入後、周辺（左手側）の電源を投入し、デバイス上で無線機器を検索してペアリングします。
- 各デバイス側でキーボードの物理レイアウトをUS配列に設定してください。

> [!TIP]
> -  周辺（左手側）はセントラル（右手側）経由でPCに接続されます。セントラルは単独で使用できますが、周辺（左手側）はセントラル側と同時に使用する必要があります。

## LEDインジケーター(手前側)の読み方

### バッテリーステータス（起動時）
- バッテリーレベルに応じて 🟢(100%)/🟡(30%)/🔴(10%) に点滅します。

### 接続状態（バッテリーステータスが表示された後）
- [右手側]🔵点滅：デバイスへ接続済み、🟡：接続待ち、🔴：切断
- [左手側]🔵点滅：セントラルへ接続済み、🔴：切断

### レイヤー状態（レイヤー変更時）
- [右手側]🔵点滅：アクティブにしたレイヤー番号に応じて点滅します。

## LEDインジケーター(奥側)の読み方

### バッテリー充電状況
- マイコンがバッテリー充電中にLEDが🔴に点灯します。
- 充電が完了するとLEDが消灯します。

<br>


## デフォルトキーマップ

本キーマップは、マルチレイヤー構造により限られたキー数でフルキーボード相当の入力を表現する構成となっています。  
標準設定はWindows環境での利用を想定しています。

### レイヤーごとの説明

| レイヤー | 概要 |
| --- | --- |
| デフォルトレイヤー | 通常入力用の基本レイヤーです。文字入力と基本操作を中心に割り当てています。 |
| セカンダリレイヤー | 数字入力用レイヤーです。左手側は数字列、右手側はテンキー配列を利用できます。 |
| ターシャリレイヤー | 補助操作レイヤーです。左手側は記号入力、右手側はカーソル操作などを割り当てています。 |
| システムレイヤー | システム操作レイヤーです。左手側にファンクションキー、右手側にUSB/BLE切替、BLE接続先切替、システムリセット、トラックパッド感度設定などを配置しています。 |

### キーマップ全体

以下に、デフォルトキーマップ全体の画像を掲載予定です。

<!-- TODO: キーマップ全体画像を挿入 -->

## トラックパッドの機能

### トラックパッド用仮想キーについて
トラックパッド用仮想キーは、キーマップ下段側に配置される「物理キーのない設定用キー」です。  
これらはトラックパッドの各種ジェスチャーと紐づいており、ジェスチャーが発動したタイミングで、該当する仮想キー（MB1〜7+ZMOD）に設定されたキーコードやBehaviorがZMKから出力されます。

- 出力内容は通常キーと同様にキーマップ編集で変更できます。
- 実際の割り当ては、後述の「トラックパッドの機能一覧」を参照してください。
- ZMODにはズームインアウト時にスクロールと共に出力される修飾キーを指定します。デフォルトではLCTRLですが、MAC向けにCMDキー等を使いたい場合に有用です。

### トラックパッド用仮想キーマップ（MB1〜7+ZMOD）
以下に、MB1〜7を印字した仮想キーマップ画像を掲載予定です。

<!-- TODO: トラックパッド用仮想キーマップ画像（MB1〜MB7）を挿入 -->

### トラックパッドの機能一覧
| レイヤー | Keymap | 操作内容 | デフォルト出力 |
| --- | --- | --- | --- |
| デフォルト | - | 1本指ドラッグ | カーソル移動 |
|  | - | 2本指ドラッグ | スクロール上下左右 |
|  | MB1 | 1本指でのタップ(プレス&ホールド) | 左クリック |
|  | MB2 | 2本指でのタップ(プレス&ホールド) | 右クリック |
|  | MB3 | 3本指でのタップ(プレス&ホールド) | 中クリック |
|  | ZMOD | 2本指ピンチイン | Ctrl+スクロール（縮小） |
|  | ZMOD | 2本指ピンチアウト | Ctrl+スクロール（拡大） |
|  | MB4 | 3本指スワイプ左 | 戻る |
|  | MB5 | 3本指スワイプ右 | 進む |
|  | MB6 | 3本指スワイプ上 | Win+Tab（タスクビュー） |
|  | MB7 | 3本指スワイプ下 | Win+D（デスクトップ表示） |
| セカンダリ | MB4 | 3本指スワイプ左 | Win+Ctrl+←（Win仮想デスクトップ切替） |
|  | MB5 | 3本指スワイプ右 | Win+Ctrl+→（Win仮想デスクトップ切替） |

### プレス&ホールドとは？
- タッチしたまま200ミリ秒以上の長押しを行うと、出力がホールドされます。
- これにより、ホールド中はマウスのドラッグのような操作が可能です。
- 再びタップすることでホールドが解除されます。
- このしきい値（200ミリ秒）は、キーボードのコンフィグファイルで変更可能です。


## キーマップの変更
LalaPadGen2はZMKファームウェアの搭載により、すべてのキー及び5Wayスイッチ及び、トラックパッドジェスチャーの出力等に対する動作をユーザーが独自に編集することができます。
指定可能なキーコードや細かい振舞い等の具体的な内容については以下よりご確認いただけます。

- [キーコード一覧](https://zmk.dev/docs/keymaps/list-of-keycodes)
- [behavior一覧](https://zmk.dev/docs/keymaps/behaviors)
  
### [ZMK Studio（ベータ版）](https://zmk.studio/)を使用
- Webブラウザ上で簡単に編集可能（USB経由)
- ネイティブアプリ版を使えば無線接続のまま編集可能
- ファームウェアのビルド不要
    
    - 参考：[ZMK Studio - ZMK Firmwear Docs](https://zmk.dev/docs/features/studio)

### [KeymapEditor](https://nickcoutsos.github.io/keymap-editor/)を使用
- Webブラウザ上で簡単に編集可能
- ZMK Studioより詳細な設定が可能
- ファームウェアをビルドする為にGitHubアカウントが必要です
    
    - [KeymapEditorの使い方]()<br/>
 　

### ファームウェアを直接カスタマイズ
- ZMKの全ての機能を利用できます
- キーボードのプロパティを変更できます（トラックパッドの細かい挙動やスリープ時間の閾値調整等）
- 若干のC言語+DeviceTreeの知識が必要です
    
    - [ファームウェアを直接変更する方法]()<br/>
 
 <br/>

> [!WARNING]
> - iPhoneやiPadなどIOS端末によるファームウェアのキーボードへの直接の書き込みは対応していませんので、PCかAndroid端末を使用する必要があります。
> - ZMK Studioを使用するなどファームウェアの書き換えを伴わなければ、IOS完結でキーマップの変更可能です。

<br/><br/>
